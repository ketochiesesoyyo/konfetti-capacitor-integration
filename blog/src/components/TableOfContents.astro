---
// Table of Contents is generated client-side from the article headings
---

<nav id="toc" class="text-sm rounded-bloom bg-white p-5 shadow-xs border border-border/50" aria-label="Tabla de contenidos">
	<h3 class="font-semibold mb-3 text-base font-sans" style="color: hsl(345, 25%, 20%)">Contenido</h3>
	<ul id="toc-list" class="space-y-2 text-muted-foreground"></ul>
</nav>

<script>
	function buildToc() {
		const article = document.querySelector('article');
		const tocList = document.getElementById('toc-list');
		if (!article || !tocList) return;

		const headings = article.querySelectorAll('h2, h3');
		if (headings.length === 0) {
			const toc = document.getElementById('toc');
			if (toc) toc.style.display = 'none';
			return;
		}

		headings.forEach((heading, i) => {
			if (!heading.id) {
				heading.id = `heading-${i}`;
			}

			const li = document.createElement('li');
			const a = document.createElement('a');
			a.href = `#${heading.id}`;
			a.textContent = heading.textContent;
			a.className = 'no-underline hover:text-konfetti-600 transition-all duration-300 block';

			if (heading.tagName === 'H3') {
				li.className = 'pl-3';
			}

			li.appendChild(a);
			tocList.appendChild(li);
		});
	}

	buildToc();
</script>
